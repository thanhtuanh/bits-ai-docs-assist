services:
  # Backend Service
  - type: web
    name: bits-ai-docs-assist-backend
    env: java
    buildCommand: cd backend && mvn clean package -DskipTests
    startCommand: cd backend && java -Dserver.port=$PORT -jar target/ai-doc-assist-0.0.1-SNAPSHOT.jar
    envVars:
      - key: SPRING_PROFILES_ACTIVE
        value: production
      - key: CORS_ALLOWED_ORIGINS
        value: https://bits-ai-docs-assist-demo.onrender.com,https://bits-ai-docs-assist.onrender.com
      - key: API_FRONTEND_ORIGIN
        value: https://bits-ai-docs-assist-demo.onrender.com
      - key: OPENAI_API_KEY
        sync: false  # Set this manually in Render dashboard
      - key: OPENAI_MODEL
        value: gpt-3.5-turbo
      - key: OPENAI_MAX_TOKENS
        value: 500
      - key: OPENAI_TEMPERATURE
        value: 0.3
      - key: DEMO_MODE
        value: true
      - key: DEMO_MOCK_AI
        value: false
      - key: MAX_FILE_SIZE
        value: 10MB
      - key: LOG_LEVEL
        value: DEBUG

  # Frontend Service
  - type: web
    name: bits-ai-docs-assist-frontend
    env: static
    buildCommand: cd frontend && npm install && npm run build
    staticPublishPath: frontend/dist
    envVars:
      - key: API_BACKEND_URL
        value: https://bits-ai-docs-assist-backend.onrender.com
